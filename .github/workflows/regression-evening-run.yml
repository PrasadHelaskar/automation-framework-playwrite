name: Playwright Evening Run

on:
  schedule:
    - cron: "30 12 * * *"
  
  workflow_dispatch:

jobs:
  self-heal-evening:
    name: Evening Playwright Stability Run
    runs-on: ubuntu-latest
    env:
      LOGGER_BASE_PATH: ${{ vars.LOGGER_BASE_PATH }}
      USERNAME: ${{ vars.USERNAME }}
      PASSWORD: ${{ vars.PASSWORD }}
      URL: ${{ vars.URL }}

    steps:
      - name: Initial checkout
        uses: actions/checkout@v4

      - name: Python Set-up
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
        
      - name: Dependencies
        run: |
          python3 -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Prepare artifact directories
        run: |
          mkdir -p logs 
          mkdir -p reports
      
      - name: Running The Regession Test Cases
        run: |
          PYTHONPATH=$PWD pytest -vv -m flows tests/

      - name: Upload logs and reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: playwright-regression-artifacts
          path: |
            logs/
            reports/